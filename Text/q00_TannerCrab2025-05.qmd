---
title: "2025 Tanner Crab Assessment Considerations"
author:
- name: William T. Stockhausen
  affiliations:
    - id: afsc-refm
      name: "Alaska Fisheries Science Center"
      department: "Resource Ecology and Fisheries Management"
      address: 
        - "7600 Sand Point Way N.E."
        - "Seattle, Washington 98115-6349"
date: '`r format(Sys.time(), "%b %e, %Y")`'
fontsize: 11pt 
number-sections: true
number-depth: 3
reference-location: document
reference-section-title: References
bibliography: '`r path.expand("~/Work/Projects/Bibliography/AllRefs.bib")`'
csl: '`r system.file("files/CJFAS.csl",package="wtsQMD")`'
link-citations: true
crossref:
  chapters: false      # prepend label reference numbers by chater number?
  fig-title: Figure    # for caption: default is "Figure")
  tbl-title: Table     # for caption: default is "Table")
  title-delim: "."     # for caption: default is ":")
  fig-prefix: Figure   # for in-text (use [-@fig-ref] to drop prefix in text)
  tbl-prefix: Table    # for in-text (use [-@tbl-ref] to drop prefix in text)
  fig-labels: arabic    # options are arabic, roman, roman i, alpha x, alpha X; latter two starting from x/X
  tbl-labels: arabic    # options are arabic, roman, roman i, alpha x, alpha X; latter two starting from x/X
  subref-labels: alpha a # options are arabic, roman, roman i, alpha x, alpha X; latter two starting from x/X
  ref-hyperlink: true    # references are hyperlinked if true
format: 
  html: 
    df-print: paged
    toc: true
    toc-location: right
    fig-width: 8
    fig-asp: 0.4
    fig-dpi: 100
    embed-resources: true
    include-in-header: 
      - '`r system.file("files/in-line_math_mode.html",package="wtsQMD")`'
  pdf:
    documentclass: scrartcl
    toc: false
    fig_crop: false
    keep-tex: false
    fig-width: 6.5
    fig-asp: 0.4
    geometry:
      - left=1.0in
      - right=1.0in
      - top=1.0in
      - bottom=1.0in
      - textwidth=6.5in
      - showframe=false
    include-in-header: 
      - text: |
          \usepackage{placeins}
          \extrafloats{500}
          \maxdeadcycles=10000
          \usepackage{fontspec}
          \usepackage{multicol}
          \usepackage{hhline}
          \newlength\Oldarrayrulewidth
          \newlength\Oldtabcolsep
      - file: '`r system.file("files/ltx_ExtraLatexIncludes.tex",package="wtsQMD")`'
echo: false
message: false
warning: false
results: 'hide'
keep-md: true
keep-yaml: false
editor: source
editor_options: 
  chunk_output_type: console
concordance: true
params:
  setup: !expr 'system.file("files/qmd_setup.R",package="wtsQMD")'
  rdaAsmtSetup: "rda_AssessmentSetup.RData"
  dirAsmt: "~/Work/StockAssessments-Crab/Assessments/TannerCrab/2024-09_TannerCrab/AssessmentData/Data_Surveys_NMFS"
  testing: false
  reorderTables: false   #--issue with finding "range" of table values  (don't use)
  reorderFigures: false  #--issue with finding "range" of figure values (don't use)
---
<!-- IMPORTANT: if used as a child doc, all chunk labels must be unique within the overall document -->

<!-- 
  NOTEs: 
     * child_path$peek() gives path to current script folder.
     * before starting a child document, do 
         "child_path$push(file.path(child_path$peek(),rel_path))" first, 
         where rel_path is the relative path to the child
     * after a child document has finished, do "child_path$pop()" to return to current path value
-->

<!-- if not child doc, set up required objects -->
```{r}
#| label: REPT_setup
#| eval: !expr '!knitr::opts_knit$get("child")'
#| results: "asis"
  testing = params$testing;
  if (testing) cat(params$setup,"\n\n")
  source(params$setup);
  if (testing) cat("root = ",root,"\n\n")
  reorderTables  = params$reorderTables;
  reorderFigures = params$reorderFigures;
```

```{r}
#| label: setup_REPT
#| results: 'asis'
  require(ggplot2);
  require(kableExtra);
  require(tables);
  Sum = wtsUtilities::Sum;
  old_thm = ggplot2::theme_set(cowplot::theme_cowplot(font_size = 10) +
                               cowplot::background_grid() +
                               cowplot::panel_border());
  thm = wtsPlots::getStdTheme();
  options("readr.show_col_types"=FALSE);
  if (testing) cat("dirThs =",child_path$peek(),"\n\n")
  ##--NOTE: take out or modify the following as necessary
  if (!exists("s")){
    if (rstudioapi::isAvailable())
      fn = file.path(rstudioapi::getActiveProject(),"rda_ProjectSetup.RData");
    if (child_path$peek()!="")
      fn = file.path(child_path$peek(),"../rda_ProjectSetup.RData");
    #--for debugging: ;
    if (file.exists(fn)) s = wtsUtilities::getObj(fn);
  }
  ##--
```

\begin{center}
THIS INFORMATION IS DISTRIBUTED SOLELY FOR THE PURPOSE OF 
PREDISSEMINATION PEER REVIEW UNDER APPLICABLE INFORMATION QUALITY GUIDELINES. 
IT HAS NOT BEEN FORMALLY DISSEMINATED BY NOAA FISHERIES/ALASKA FISHERIES SCIENCE CENTER AND 
SHOULD NOT BE CONSTRUED TO REPRESENT ANY AGENCY DETERMINATION OR POLICY
\end{center}


# Introduction 

The next full assessment for the Tanner crab stock will be reviewed by the Crab Plan Team (CPT) in September 2025 and the NPFMC's Science and Statistical Committee (SSC) in October 2025. The stock is on an annual cycle for assessment, with the last full assessment conducted in September 2024 [@TannerCrab2024]. 

This report addresses several topics, including new analyses, potential (bespoke) TCSAM02 models for the Fall 2025 stock assessment, and work to develop a GMACS version of the Tanner crab assessment model. Among new analyses ([@sec-Analyses]), the AFSC's Shellfish Assessment Program (SAP) has developed an R package, `crabpack`, as a replacement to AKFIN Answers (https://akfin.psmfc.org) for obtaining crab-related survey data in a standard format. SAP staff requested that assessment authors test the package and compare results of data pulls using the package with data pulled using the authors' previous methods. Results of this comparison are presented in Second, 

This report is organized into the following sections: Responses to previous CPT and SSC Comments (@sec-Resps), Analyses (@sec-Analyses), TCSAM02 model runs and results (@sec-TCSAM02), GMACS model runs and results (@sec-GMACS), Summary (@sec-Smry), and Acknowledgments (@sec-Acks).

<!-- # Responses to CPT and SSC Comments {#sec-Resps} -->
```{r sct_Resps, child=file.path(child_path$peek(),"q01_TannerCrab_ResponsesToComments2025.qmd")}
```

<!-- # "New" Data and Analyses {#sec-Analyses} -->
```{r sct_Analyses, child=file.path(child_path$peek(),"q02_Analyses.qmd")}
```

<!-- # TCSAM02 Models {#sec-TCSAM02} -->
```{r sct_TCSAM02, child=file.path(child_path$peek(),"q03_TCSAM02_Models.qmd")}
```

<!-- # GMACS Models {#sec-GMACS} -->
```{r sct_GMACS, child=file.path(child_path$peek(),"q03_GMACS_Models.qmd")}
```

# Summary {#sec-Smry}

The author recommends using the full-precision carapace length measurements with the current length-weight regressions to calculate biomass from NMFS EBS survey abundance and size data.

The author looks forward to discussions with the CPT and SSC regarding model choices for the September assessment and further refinements to address on a longer timescale.

# Acknowledgments {#sec-Acks}

The author would like to acknowledge Andre Punt (UW) and Matthieu Veron (??) for recent improvements to GMACS, ...
Jon Richar for VAST size comps
Shannon Hennessey and SAP for developing the `crabpack` package
Cole, Jim Ianelli, Andre, other crab assessment authors
Lee Cronin-Fine for internal review

<!-- references -->
```{r,eval=!knitr::opts_knit$get("child"),results='asis'}
  cat("# References {-}\n");
  cat("::: {#refs}\n");
  cat(":::\n\n");
```

<!-- tables, if not child doc and lstTbls is not empty -->
```{r}
#| label: tables_REPT
#| eval: !expr '!knitr::opts_knit$get("child")'
#| results: asis
  source(system.file("files/printTablesSectionFromList.R",package="wtsQMD"));
```

<!-- figures, if not child doc and lstFigs is not empty -->
```{r}
#| label: figures_REPT
#| eval: !expr '!knitr::opts_knit$get("child")'
#| results: asis
  source(system.file("files/printFiguresSectionFromList.R",package="wtsQMD"));
```
